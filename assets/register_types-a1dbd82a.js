var dt=Object.defineProperty;var pt=(o,t,e)=>t in o?dt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var v=(o,t,e)=>(pt(o,typeof t!="symbol"?t+"":t,e),e);import{g as Q,p as ut,A as E,C as f,a as p,s as c,T as m,c as ft,r as mt,E as k,P as tt,S as bt,R as gt,G as yt,b as et,d as _t,I as it,e as st,f as vt,L as wt,h as u,i as St}from"./needle-engine-90c4a82e.js";import{V as S,a as W,M as xt,C as It,O as z,L as Pt,R as Ot,E as Ct}from"./three.module-66b7478a.js";import"./index-f96d51ab.js";var Lt=Object.defineProperty,Ft=Object.getOwnPropertyDescriptor,At=(o,t,e,s)=>{for(var i=s>1?void 0:s?Ft(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&Lt(t,e,i),i};const F=Q("debugsyncanimator"),nt=class extends f{constructor(){super(...arguments),this.syncedAnimGuid=null,this.localParameters=[],this.currentController=null,this.isSyncAnim=!0,this.tempValues=[],this.modelRecieved=o=>{var s,i;if(!this.animator)return;F&&console.log(`${this.context.time.time.toFixed(2)} SyncAnimator incoming message`);for(let n=0;n<o.values.length;n++){const r=this.localParameters[n],h=o.values[n];var t=null;switch(r.type){case p.Trigger:case p.Bool:t=h==1;break;case p.Float:case p.Int:t=h||0;break}t!==r.value&&(F&&console.log(`Remote parameter: ${r.name} | ${r.value} --> ${t}`),r.value=t)}const e=o.state;if(e!==0){const n=(s=this.animator.runtimeAnimatorController)==null?void 0:s.findState(e);this.remoteState=n,F&&console.log(`${this.context.time.time.toFixed(2)} Remote state: ${(i=this.currentState)==null?void 0:i.name} --> ${n==null?void 0:n.name}`)}}}set SyncedAnimGuid(o){this.unregisterNetMessage(),this.syncedAnimGuid=o,this.registerNetMessage()}get SyncedAnimGuid(){return this.syncedAnimGuid}get currentState(){var o,t;return(t=(o=this.animator)==null?void 0:o.runtimeAnimatorController)==null?void 0:t.activeState}start(){this.SyncedAnimGuid??(this.SyncedAnimGuid=`${this.guid}`),this.enabled=this.localParameters!==void 0,this.enabled||console.warn("SyncAnimator has to be on an object with an Animator componenet")}onControllerChanged(){var o,t,e;this.animator=this.gameObject.getComponent(E),this.currentController=(o=this.animator)==null?void 0:o.runtimeAnimatorController,this.localParameters=(e=(t=this.currentController)==null?void 0:t.model)==null?void 0:e.parameters}registerNetMessage(){this.context.connection.beginListen(this.syncedAnimGuid,this.modelRecieved)}unregisterNetMessage(){this.context.connection.stopListen(this.syncedAnimGuid,this.modelRecieved)}onDestroy(){this.unregisterNetMessage()}onBeforeRender(){if(this.isSyncAnim!==void 0)return;const o=this.gameObject.getComponent(nt);!o||!o.enabled||(o.syncedAnimatorUpdate(),o.applyRemoteState(),o.dispatchChanges())}syncedAnimatorUpdate(){var o;this.currentController!==((o=this.animator)==null?void 0:o.runtimeAnimatorController)&&this.onControllerChanged()}applyRemoteState(){var o;this.remoteState&&this.remoteState!==this.currentState&&((o=this.animator.runtimeAnimatorController)==null||o.play(this.remoteState.hash),this.remoteState=null)}dispatchChanges(){!this.animator.parametersAreDirty&&!this.animator.isDirty||this.createAndSndModel(this.localParameters,this.animator.isDirty?this.currentState:void 0)}createAndSndModel(o,t){const e=this.context.connection;if(!e.isInRoom)return;this.tempValues.length=o.length;for(let n=0;n<o.length;n++){const r=o[n];var s=0;switch(r.type){case p.Trigger:case p.Bool:s=r.value?1:0;break;case p.Float:case p.Int:s=r.value;break}this.tempValues[n]=s}const i={guid:this.syncedAnimGuid,values:this.tempValues,state:(t==null?void 0:t.hash)||0};F&&console.log(`${this.context.time.time.toFixed(2)} SyncAnimator outgoing message`),e.send(this.guid,i)}};let j=nt;At([ut(E)],j.prototype,"onBeforeRender",1);var Dt=Object.defineProperty,$t=Object.getOwnPropertyDescriptor,x=(o,t,e,s)=>{for(var i=s>1?void 0:s?$t(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&Dt(t,e,i),i};class I extends f{constructor(){super(...arguments),this.animParam="",this.animParamToDisable=""}awake(){var e,s,i;const t=(i=(s=(e=this.animator)==null?void 0:e.runtimeAnimatorController)==null?void 0:s.model)==null?void 0:i.parameters;t&&(this.parameter=t.find(n=>n.name===this.animParam))}onPointerClick(t){var i,n,r;if(!this.animator||!this.syncAnimator||!this.parameter)return;const e=this.parameter.type;if(e==p.Float){var s=this.animator.getFloat(this.animParam)+.6;s>=1.7&&(s=0),this.animator.setFloat(this.animParam,s)}if((e==p.Bool||e==p.Trigger)&&this.animator.setBool(this.animParam,!this.parameter.value),this.animParamToDisable!=""){const h=(r=(n=(i=this.animator)==null?void 0:i.runtimeAnimatorController)==null?void 0:n.model)==null?void 0:r.parameters;if(!h)return;const l=h.find(a=>a.name===this.animParamToDisable);if(l){const a=l.type;a==p.Float||a==p.Int?this.animator.setFloat(this.animParamToDisable,0):(a==p.Bool||a==p.Trigger)&&this.animator.setBool(this.animParamToDisable,!1)}}}update(){if(this.parameter&&this.valueLabel){var t="";this.parameter.type==p.Float||this.parameter.type==p.Int?t=this.parameter.value.toFixed(1):t=`${this.parameter.value}`,this.valueLabel.text=t}}}x([c(E)],I.prototype,"animator",2);x([c(j)],I.prototype,"syncAnimator",2);x([c()],I.prototype,"animParam",2);x([c()],I.prototype,"animParamToDisable",2);x([c(m)],I.prototype,"valueLabel",2);class M extends f{constructor(){super(...arguments),this.animName=""}onPointerClick(t){this.animator&&this.syncAnimator&&this.animator.play(this.animName)}}x([c(E)],M.prototype,"animator",2);x([c(j)],M.prototype,"syncAnimator",2);x([c()],M.prototype,"animName",2);const N=2,b=4,y=4,rt=4,w=new Int32Array(2),X=new Float32Array(w.buffer),K=new Float64Array(w.buffer),A=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;class _{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?_.ZERO:new _(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}}_.ZERO=new _(0,0);var G;(function(o){o[o.UTF8_BYTES=1]="UTF8_BYTES",o[o.UTF16_STRING=2]="UTF16_STRING"})(G||(G={}));class ${constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new $(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new _(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new _(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return w[0]=this.readInt32(t),X[0]}readFloat64(t){return w[A?0:1]=this.readInt32(t),w[A?1:0]=this.readInt32(t+4),K[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){X[0]=e,this.writeInt32(t,w[0])}writeFloat64(t,e){K[0]=e,this.writeInt32(t,w[A?0:1]),this.writeInt32(t+4,w[A?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+b+y)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<y;e++)t+=String.fromCharCode(this.readInt8(this.position_+b+e));return t}__offset(t,e){const s=t-this.readInt32(t);return e<this.readInt16(s)?this.readInt16(s+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const s=this.readInt32(t);let i="",n=0;if(t+=b,e===G.UTF8_BYTES)return this.bytes_.subarray(t,t+s);for(;n<s;){let r;const h=this.readUint8(t+n++);if(h<192)r=h;else{const l=this.readUint8(t+n++);if(h<224)r=(h&31)<<6|l&63;else{const a=this.readUint8(t+n++);if(h<240)r=(h&15)<<12|(l&63)<<6|a&63;else{const g=this.readUint8(t+n++);r=(h&7)<<18|(l&63)<<12|(a&63)<<6|g&63}}}r<65536?i+=String.fromCharCode(r):(r-=65536,i+=String.fromCharCode((r>>10)+55296,(r&1024-1)+56320))}return i}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+b}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=y)throw new Error("FlatBuffers: file identifier must be length "+y);for(let e=0;e<y;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+b+e))return!1;return!0}createLong(t,e){return _.create(t,e)}createScalarList(t,e){const s=[];for(let i=0;i<e;++i)t(i)!==null&&s.push(t(i));return s}createObjList(t,e){const s=[];for(let i=0;i<e;++i){const n=t(i);n!==null&&s.push(n.unpack())}return s}}class H{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=$.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const s=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<s+t+e;){const i=this.bb.capacity();this.bb=H.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(s)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,s){(this.force_defaults||e!=s)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,s){(this.force_defaults||e!=s)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,s){(this.force_defaults||e!=s)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,s){(this.force_defaults||!e.equals(s))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,s){(this.force_defaults||e!=s)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,s){(this.force_defaults||e!=s)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,s){(this.force_defaults||e!=s)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,s){e!=s&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const s=e<<1,i=$.allocate(s);return i.setPosition(s-e),i.bytes().set(t.bytes(),s-e),i}addOffset(t){this.prep(b,0),this.writeInt32(this.offset()-t+b)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const s=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const i=2;this.addInt16(t-this.object_start);const n=(s+i)*N;this.addInt16(n);let r=0;const h=this.space;t:for(e=0;e<this.vtables.length;e++){const l=this.bb.capacity()-this.vtables[e];if(n==this.bb.readInt16(l)){for(let a=N;a<n;a+=N)if(this.bb.readInt16(h+a)!=this.bb.readInt16(l+a))continue t;r=this.vtables[e];break}}return r?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,r-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,s){const i=s?rt:0;if(e){const n=e;if(this.prep(this.minalign,b+y+i),n.length!=y)throw new Error("FlatBuffers: file identifier must be length "+y);for(let r=y-1;r>=0;r--)this.writeInt8(n.charCodeAt(r))}this.prep(this.minalign,b+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const s=this.bb.capacity()-t,i=s-this.bb.readInt32(s);if(!(this.bb.readInt16(i+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,s){this.notNested(),this.vector_num_elems=e,this.prep(b,t*e),this.prep(s,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let s=0;for(;s<t.length;){let i;const n=t.charCodeAt(s++);if(n<55296||n>=56320)i=n;else{const r=t.charCodeAt(s++);i=(n<<10)+r+(65536-56623104-56320)}i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(i&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let s=0,i=this.space,n=this.bb.bytes();s<e.length;s++)n[i++]=e[s];return this.endVector()}createLong(t,e){return _.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let s=0;s<t.length;++s){const i=t[s];if(i!==null)e.push(this.createObjectOffset(i));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class d{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSendBuffer_Model(t,e){return(e||new d).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSendBuffer_Model(t,e){return t.setPosition(t.position()+rt),(e||new d).__init(t.readInt32(t.position())+t.position(),t)}guid(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}guidLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}guidArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}dontSave(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}prefix(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}seconds(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt32(this.bb_pos+t):0}static startSendBuffer_Model(t){t.startObject(4)}static addGuid(t,e){t.addFieldOffset(0,e,0)}static createGuidVector(t,e){t.startVector(1,e.length,1);for(let s=e.length-1;s>=0;s--)t.addInt8(e[s]);return t.endVector()}static startGuidVector(t,e){t.startVector(1,e,1)}static addDontSave(t,e){t.addFieldInt8(1,+e,0)}static addPrefix(t,e){t.addFieldOffset(2,e,0)}static addSeconds(t,e){t.addFieldInt32(3,e,0)}static endSendBuffer_Model(t){return t.endObject()}static finishSendBuffer_ModelBuffer(t,e){t.finish(e)}static finishSizePrefixedSendBuffer_ModelBuffer(t,e){t.finish(e,void 0,!0)}static createSendBuffer_Model(t,e,s,i,n){return d.startSendBuffer_Model(t),d.addGuid(t,e),d.addDontSave(t,s),d.addPrefix(t,i),d.addSeconds(t,n),d.endSendBuffer_Model(t)}}var ot={exports:{}};(function(o,t){(function(e,s){o.exports=s()})(ft,function(){return function(e){var s={};function i(n){if(s[n])return s[n].exports;var r=s[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=s,i.d=function(n,r,h){i.o(n,r)||Object.defineProperty(n,r,{enumerable:!0,get:h})},i.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},i.t=function(n,r){if(1&r&&(n=i(n)),8&r||4&r&&typeof n=="object"&&n&&n.__esModule)return n;var h=Object.create(null);if(i.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:n}),2&r&&typeof n!="string")for(var l in n)i.d(h,l,function(a){return n[a]}.bind(null,l));return h},i.n=function(n){var r=n&&n.__esModule?function(){return n.default}:function(){return n};return i.d(r,"a",r),r},i.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},i.p="",i(i.s=0)}([function(e,s,i){i.r(s),i.d(s,"UuidTool",function(){return h}),i.d(s,"Uuid",function(){return r});var n={uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i},r=function(){function l(a){this.id="",typeof a=="string"?this.fromString(a):Array.isArray(a)?this.fromBytes(a):this.generate()}return l.fromJson=function(a){if(typeof a=="string"&&(a=JSON.parse(a)),!a||!a.id)throw new TypeError("The input cannot be converted to Uuid.");return new l(a.id)},l.prototype.generate=function(){var a=new Array(16).fill(0).map(function(){return 256*Math.random()&255});return a[6]=79&(64|a[6]),this.fromBytes(a),this},l.prototype.fromBytes=function(a){return this.id=a.map(function(g){return("00"+g.toString(16)).slice(-2)}).join("").replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/,"$1-$2-$3-$4-$5"),this.id=this.toString(),this},l.prototype.toBytes=function(){return(this.id.replace(/-/g,"").match(/.{2}/g)||[]).map(function(a){return parseInt(a,16)})},l.prototype.fromString=function(a){return this.id=a.trim(),this.id=this.toString(),this},l.prototype.toString=function(){switch(l.stringExportFormat){default:case"lowercase":return this.id.toLowerCase();case"uppercase":return this.id.toUpperCase()}},l.prototype.isValid=function(){return typeof this.id=="string"&&this.id.length===36&&n.uuid.test(this.id)},l.prototype.equals=function(a){return typeof a=="string"&&(a=new l(a)),this.toString()===a.toString()},l.stringExportFormat="lowercase",l}(),h=function(){function l(){}return l.toBytes=function(a){return new r().fromString(a).toBytes()},l.toString=function(a){return new r().fromBytes(a).toString()},l.newUuid=function(){return new r().toString()},l.isUuid=function(a){return new r().fromString(a).isValid()},l.compare=function(a,g){return new r(a).equals(new r(g))},l}()}])})})(ot);var Et=ot.exports,jt=Object.defineProperty,Mt=Object.getOwnPropertyDescriptor,T=(o,t,e,s)=>{for(var i=s>1?void 0:s?Mt(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&jt(t,e,i),i};const D="MESG";mt(D,d.getRootAsSendBuffer_Model);class O extends f{constructor(){super(...arguments),this.saveState=!0,this.recieveBuffer=t=>{this.msgLabel&&(this.msgLabel.text=`${t.prefix()} ${t.seconds()}`)}}onEnable(){this.context.connection.beginListenBinary(D,this.recieveBuffer)}onDisable(){this.context.connection.stopListenBinary(D,this.recieveBuffer)}sendBuffer(){const t=new H(0),e=d.createGuidVector(t,Et.UuidTool.toBytes(this.guid)),s=!this.saveState,i=t.createString("Hello, it is "),n=Math.floor(this.context.time.time);console.log(e),d.startSendBuffer_Model(t),d.addGuid(t,e),d.addDontSave(t,s),d.addPrefix(t,i),d.addSeconds(t,n);const r=d.endSendBuffer_Model(t);t.finish(r,D);const h=t.asUint8Array();this.context.connection.sendBinary(h),this.outgoingSizeLabel&&(this.outgoingSizeLabel.text=`${h.length} bytes`)}deleteState(){this.context.connection.sendDeleteRemoteState(this.guid)}awake(){this.updateSaveStateLabel()}toggleSaveState(){this.saveState=!this.saveState,this.updateSaveStateLabel()}updateSaveStateLabel(){this.saveStateLabel&&(this.saveStateLabel.text=`Save state: ${this.saveState}`)}}T([c(m)],O.prototype,"msgLabel",2);T([c(m)],O.prototype,"saveStateLabel",2);T([c(m)],O.prototype,"outgoingSizeLabel",2);T([c()],O.prototype,"saveState",2);var Tt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,B=(o,t,e,s)=>{for(var i=s>1?void 0:s?Bt(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&Tt(t,e,i),i};class C extends f{constructor(){super(...arguments),this.saveState=!0,this.msgId="SendMessage",this.recieveMessage=t=>{this.msgLabel&&(this.msgLabel.text=`${t.prefix} ${t.seconds}`)}}onEnable(){this.context.connection.beginListen(this.msgId,this.recieveMessage)}onDisable(){this.context.connection.stopListen(this.msgId,this.recieveMessage)}sendMessage(){const t={guid:this.guid,dontSave:!this.saveState,prefix:"Hello, it is ",seconds:Math.floor(this.context.time.time)};if(this.context.connection.send(this.msgId,t),this.outgoingSizeLabel){const e=new TextEncoder().encode(JSON.stringify(t));this.outgoingSizeLabel.text=`${e.length} bytes`}}deleteState(){this.context.connection.sendDeleteRemoteState(this.guid)}awake(){this.updateSaveStateLabel()}toggleSaveState(){this.saveState=!this.saveState,this.updateSaveStateLabel()}updateSaveStateLabel(){this.saveStateLabel&&(this.saveStateLabel.text=`Save state: ${this.saveState}`)}}B([c(m)],C.prototype,"msgLabel",2);B([c(m)],C.prototype,"saveStateLabel",2);B([c(m)],C.prototype,"outgoingSizeLabel",2);B([c()],C.prototype,"saveState",2);var Rt=Object.defineProperty,Ut=Object.getOwnPropertyDescriptor,Vt=(o,t,e,s)=>{for(var i=s>1?void 0:s?Ut(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&Rt(t,e,i),i};let at=class extends f{constructor(){super(...arguments),this.msgId="EventListOnClick",this.model=new Nt}onEnable(){this.onClickMsgHandler=this.handleOnClickMsg.bind(this),this.context.connection.beginListen(this.msgId,this.onClickMsgHandler)}onDisable(){this.context.connection.stopListen(this.msgId,this.onClickMsgHandler)}handleOnClickMsg(t){t.id===this.guid&&this.callEventList()}onPointerClick(t){this.callEventList(),this.model.id=this.guid,this.context.connection.send(this.msgId,this.model)}callEventList(){var t;(t=this.onClicked)==null||t.invoke()}};Vt([c(k)],at.prototype,"onClicked",2);let Nt=class{constructor(){this.id=""}};var Gt=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,Ht=(o,t,e,s)=>{for(var i=s>1?void 0:s?zt(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&Gt(t,e,i),i};class ht extends f{constructor(){super(...arguments),this.updateLabel=()=>{this.label&&this.playerState&&(this.label.text=`${this.playerState.owner}
${this.playerState.isLocalPlayer?"<color=#ff715e>Local</color>":"Remote"}`)}}start(){this.playerState=this.gameObject.getComponentInParent(tt),this.playerState&&(this.playerState.hasOwner?this.updateLabel():this.playerState.onFirstOwnerChangeEvent.addEventListener(this.updateLabel))}}Ht([c(m)],ht.prototype,"label",2);var qt=Object.defineProperty,Zt=Object.getOwnPropertyDescriptor,R=(o,t,e,s)=>{for(var i=s>1?void 0:s?Zt(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&qt(t,e,i),i};class L extends f{constructor(){super(...arguments),this.speed=5,this.currentGoal=new S,this.pointerPos=new W,this.tempVec1=new S,this.tempVec2=new S,this.initialize=()=>{var s;if(!this.playerState||!this.mainRenderer)return;this.syncedTransform&&((s=this.playerState)!=null&&s.isLocalPlayer)&&this.syncedTransform.requestOwnership();const t=this.playerState.owner??"",e=this.mainRenderer.sharedMaterial;if(e){const i=new xt;i.copy(e);const n=parseInt(t,16);i.color=new It(n),this.mainRenderer.sharedMaterial=i}}}start(){this.playerState&&(this.playerState.hasOwner?this.initialize():this.playerState.onFirstOwnerChangeEvent.addEventListener(this.initialize),this.currentGoal.copy(this.gameObject.position))}update(){var t;if((t=this.playerState)!=null&&t.isLocalPlayer){const e=this.context.input,s=this.context.mainCamera,i=this.context.time.deltaTime,n=this.context.physics.engine;this.tempVec1.copy(this.currentGoal),this.tempVec2.copy(this.gameObject.position);const r=this.tempVec1.sub(this.tempVec2),h=this.speed*i;r.length()<h?this.gameObject.position.copy(this.currentGoal):this.gameObject.translateOnAxis(r.normalize(),h);const l=!1;if(e.getPointerDown(0)){const a=e.getPointerPosition(0);a&&this.pointerPos.copy(a)}if(e.getPointerUp(0)&&s&&((e.getPointerPosition(0)||new W).distanceTo(this.pointerPos)<40||l)){const g=n.raycast();g&&g.collider&&this.currentGoal.copy(g.point)}}}}R([c(tt)],L.prototype,"playerState",2);R([c(bt)],L.prototype,"syncedTransform",2);R([c(gt)],L.prototype,"mainRenderer",2);R([c()],L.prototype,"speed",2);var Jt=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor,q=(o,t,e,s)=>{for(var i=s>1?void 0:s?Yt(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&Jt(t,e,i),i};const Wt=Q("debugspawnhandler");class U extends f{constructor(){super(...arguments),this.spawnPoints=[],this.validIndex=-1,this.offsetForError=1,this.downVector=new S(0,-1,0),this.upVector=new S(0,1,0),this.offsetVector=new S}handlePlayerSpawn(t){const e=new _t;e.layerMask=new Pt,e.layerMask.enableAll(),e.ray=new Ot(new S,this.downVector.clone()),e.maxDistance=2;let s;this.validIndex+1>=this.spawnPoints.length?this.validIndex=0:this.validIndex++;for(let r=this.validIndex;r<this.spawnPoints.length;r++){const h=this.spawnPoints[r];if(h.getWorldPosition(e.ray.origin),e.ray.origin.y+=3,e.ray.direction.copy(this.downVector),Wt&&yt.DrawLine(e.ray.origin,e.ray.origin.clone().add(e.ray.direction.clone().multiplyScalar(e.maxDistance)),16711680,50,!0),this.context.physics.raycast(e).length==0){s=h,this.validIndex=r;break}}s||console.log("No available spawn");const i=(s==null?void 0:s.position.clone())||new S,n=(s==null?void 0:s.rotation.clone())||new Ct;this.offsetVector.set(0,0,this.offsetForError),this.offsetVector.applyAxisAngle(this.upVector,Math.random()*Math.PI*2),i.add(this.offsetVector),t instanceof z&&(t.worldToLocal(i),t.position.copy(i),t.rotation.copy(n))}}q([c(z)],U.prototype,"spawnPoints",2);q([et()],U.prototype,"validIndex",2);q([c()],U.prototype,"offsetForError",2);var Xt=Object.defineProperty,Kt=Object.getOwnPropertyDescriptor,Z=(o,t,e,s)=>{for(var i=s>1?void 0:s?Kt(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&Xt(t,e,i),i};class P extends f{constructor(){super(...arguments),this.model=new Qt}awake(){this.onModelChanged()}updateUser(){var e;this.model.guid=this.guid;let t=this.model.users.find(s=>s.userId==this.context.connection.connectionId);t||(t=new kt,this.model.users.push(t)),t.userId=this.context.connection.connectionId,t.nickname=(e=this.inputField)==null?void 0:e.text,this.model=this.model}onModelChanged(){if(st("Room data recieved"),this.displayLabel){const t=this.model.users.map(e=>`${e.nickname}`).join(`
`);this.displayLabel.text=t.length>0?t:"no data"}}}Z([et(P.prototype.onModelChanged)],P.prototype,"model",2);Z([c(m)],P.prototype,"displayLabel",2);Z([c(it)],P.prototype,"inputField",2);class Qt{constructor(){this.guid="",this.users=[]}}class kt{constructor(){this.userId="",this.nickname=""}}var te=Object.defineProperty,ee=Object.getOwnPropertyDescriptor,J=(o,t,e,s)=>{for(var i=s>1?void 0:s?ee(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&te(t,e,i),i};class V extends f{update(){var h;if((h=this.gameObject.getComponent(vt))==null||h.lockPositionX,!this.roomLabel||!this.usersLabel)return;const t=this.context.connection,e=t.currentRoomName||"",s=t.connectionId||"",i=t.currentRoomViewId||"";this.roomLabel.text=t.isInRoom?`Joined:
${e}
(${s}) (${i})
${t.currentLatency.toFixed(2)}ms`:"Not in a room";const n=t.usersInRoom().join(`
`),r=n.length>0?n:"no users";this.usersLabel.text=t.isInRoom?r:""}joinRoom(){const t=this.context.connection;this.roomNameInput&&(t.isInRoom?st("You are already in a room, you have to leave it first!",wt.Warn):t.joinRoom(this.roomNameInput.text))}disconnectRoom(){const t=this.context.connection;t.isInRoom&&t.leaveRoom()}}J([c(m)],V.prototype,"roomLabel",2);J([c(m)],V.prototype,"usersLabel",2);J([c(it)],V.prototype,"roomNameInput",2);u.add("SyncedAnimator",j);u.add("SyncedAnimatorControls_RandomValue",I);u.add("SyncedAnimatorControls_PlayAnim",M);u.add("SendBufferExample",O);u.add("SendBuffer_Model",d);u.add("SendMessageExample",C);u.add("TriggerEventListOnClick",at);u.add("PlayerStateUI",ht);u.add("SampleNetworkedPlayer",L);u.add("SpawnSpotHandler",U);u.add("RoomData",P);u.add("RoomManager",V);var ie=Object.defineProperty,se=Object.getOwnPropertyDescriptor,lt=(o,t,e,s)=>{for(var i=s>1?void 0:s?se(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&ie(t,e,i),i};class Y extends f{constructor(){super(...arguments);v(this,"playableDirectorGameObject");v(this,"playableDirector")}PlayAnimation(){var e;this.playableDirector&&((e=this.playableDirector)==null||e.play())}}lt([c(z)],Y.prototype,"playableDirectorGameObject",2);lt([c(St)],Y.prototype,"playableDirector",2);var ne=Object.defineProperty,re=Object.getOwnPropertyDescriptor,oe=(o,t,e,s)=>{for(var i=s>1?void 0:s?re(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(i=(s?r(t,e,i):r(i))||i);return s&&i&&ne(t,e,i),i};class ct extends f{constructor(){super(...arguments);v(this,"onClicked");v(this,"msgId","EventListOnClick");v(this,"onClickMsgHandler");v(this,"model",new ae)}onEnable(){this.onClickMsgHandler=this.handleOnClickMsg.bind(this),this.context.connection.beginListen(this.msgId,this.onClickMsgHandler)}onDisable(){this.context.connection.stopListen(this.msgId,this.onClickMsgHandler)}handleOnClickMsg(e){e.id===this.guid&&this.callEventList()}onPointerClick(e){this.callEventList(),this.model.id=this.guid,this.context.connection.send(this.msgId,this.model)}callEventList(){var e;(e=this.onClicked)==null||e.invoke()}}oe([c(k)],ct.prototype,"onClicked",2);class ae{constructor(){v(this,"id","")}}u.add("StartAnimation",Y);u.add("TriggerEventListOnClick",ct);
